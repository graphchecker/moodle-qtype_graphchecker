define ("qtype_graphchecker/ui_checks",["jquery"],function(a){function b(b,c,d,e){this.$textArea=a("#"+b);this.templateParams=e;this.fail=!1;this.error="";this.reload()}b.prototype.failed=function(){return this.fail};b.prototype.failMessage=function(){return this.error};b.prototype.sync=function(){var b=[],c=this.$activeChecksList.children();c.each(function(){var c=a(this),d={module:c.attr("data-module"),method:c.attr("data-method")},e=c.children(".args-container").children();if(e){var f={};e.each(function(){var b=a(this),c=b.attr("data-param-name"),d=b.children(".argument-value").val();f[c]=d});d.arguments=f}b.push(d)});this.$textArea.val(JSON.stringify(b))};b.prototype.getElement=function(){return this.$checksPanel};b.prototype.reload=function(){this.$checksPanel=a("<div/>").addClass("tests-ui");this.$activeChecksList=a("<div/>").addClass("active-tests-list").appendTo(this.$checksPanel);this.$backdrop=a("<div/>").addClass("backdrop").css("display","none").on("click",this.hideAddCheckDialog.bind(this)).appendTo(this.$checksPanel);this.$availableChecksList=a("<div/>").addClass("available-tests-list");this.$dialog=this.createDialog("Add check",this.$availableChecksList).appendTo(this.$backdrop);var b=this.$textArea.val(),c=JSON.parse(b),d=this.$textArea.attr("data-available-checks");this.modules=JSON.parse(d);for(var h=0,i;h<c.length;h++){i=c[h];this.createActiveCheckContainer(i).appendTo(this.$activeChecksList)}for(var j in this.modules){if(this.modules.hasOwnProperty(j)){var e=this.modules[j],f=this.createModuleContainer(j,e).appendTo(this.$availableChecksList),g=e.checks;for(var k in g){if(g.hasOwnProperty(k)){this.createAvailableCheckContainer(j,k,g[k]).appendTo(this.$availableChecksList)}}}}this.$addCheckButton=a("<button/>").addClass("btn btn-primary").append(a("<i/>").addClass("icon fa fa-plus")).append("Add check").on("click",this.showAddCheckDialog.bind(this)).appendTo(this.$checksPanel)};b.prototype.showAddCheckDialog=function(){this.$backdrop.css("display","block").addClass("visible");a("body").addClass("unscrollable");return!1};b.prototype.hideAddCheckDialog=function(){this.$backdrop.removeClass("visible");a("body").removeClass("unscrollable");setTimeout(function(){this.$backdrop.css("display","none")}.bind(this),500)};b.prototype.createActiveCheckContainer=function(b){var c=b.module,d=b.method,e=a("<div/>").addClass("test-container").attr("data-module",c).attr("data-method",d),f=a("<div/>").addClass("test-header").appendTo(e),g=a("<div/>").addClass("button-group").appendTo(f),h=this.createButton("fa-angle-up").attr("title","Move this check up in the list").on("click",this.moveCheckUp.bind(this)).appendTo(g),i=this.createButton("fa-angle-down").attr("title","Move this check down in the list").on("click",this.moveCheckDown.bind(this)).appendTo(g),j=this.modules[c].checks[d],k=a("<span/>").html(j.name).addClass("test-name").appendTo(f);if(j.description){this.createHelpButton(j.description).appendTo(f)}var l=a("<div/>").addClass("button-group float-right").appendTo(f),m=this.createButton("fa-trash").attr("title","Remove this check from the list").on("click",this.removeCheck.bind(this)).appendTo(l);if(j.params){this.createArgsContainer(j,b).appendTo(e)}return e};b.prototype.createArgsContainer=function(b,c){for(var d=b.params,e=c.arguments,f=a("<div/>").addClass("args-container"),g=0;g<d.length;g++){var h=d[g],j=a("<div/>").addClass("argument-row").attr("data-param-name",h.param).appendTo(f);a("<span/>").addClass("argument-name").text(h.name).appendTo(j);var q=e[h.param];if(!q){q=h["default"]}switch(h.type){case"integer":$field=a("<input/>").addClass("argument-value").attr("type","number").val(q).appendTo(j);if(h.hasOwnProperty("min")){$field.attr("min",h.min)}if(h.hasOwnProperty("max")){$field.attr("max",h.max)}break;case"string":$field=a("<input/>").addClass("argument-value").val(q).appendTo(j);break;case"choice":$field=a("<select/>").addClass("argument-value").appendTo(j);if(!h.hasOwnProperty("options")){console.error("No options provided for choice parameter");break}var k=!0,l=!1,m=void 0;try{for(var n=h.options[Symbol.iterator](),o,p;!(k=(o=n.next()).done);k=!0){p=o.value;a("<option/>").text(p).appendTo($field)}}catch(a){l=!0;m=a}finally{try{if(!k&&null!=n.return){n.return()}}finally{if(l){throw m}}}$field.val(q);break;default:console.error("Unknown type "+h.type);}}return f};b.prototype.createModuleContainer=function(b){var c=a("<div/>").addClass("module-container"),d=a("<div/>").addClass("module-header").appendTo(c),e=a("<span/>").html(this.modules[b].name).addClass("module-name").appendTo(d);return c};b.prototype.moveCheckUp=function(b){var c=a(b.target).closest(".test-container"),d=c.prev();if(d){d.before(c)}return!1};b.prototype.moveCheckDown=function(b){var c=a(b.target).closest(".test-container"),d=c.next();if(d){d.after(c)}return!1};b.prototype.removeCheck=function(b){var c=a(b.target).closest(".test-container");c.slideUp();setTimeout(function(){c.remove()}.bind(this),500);return!1};b.prototype.addCheck=function(b){var c=a(b.target).closest(".test-container"),d={module:c.attr("data-module"),method:c.attr("data-method"),arguments:[]};this.createActiveCheckContainer(d).appendTo(a(".active-tests-list")).hide().slideDown();this.hideAddCheckDialog();return!1};b.prototype.createAvailableCheckContainer=function(b,c){var d=a("<div/>").addClass("test-container").attr("data-module",b).attr("data-method",c),e=a("<div/>").addClass("test-header").appendTo(d),f=a("<div/>").addClass("button-group").appendTo(e),g=this.createButton("fa-plus").attr("title","Add this check to the list").on("click",this.addCheck.bind(this)).appendTo(f),h=this.modules[b].checks[c],i=a("<span/>").html(h.name).addClass("test-name").appendTo(e);if(h.description){this.createHelpButton(h.description).appendTo(e)}return d};b.prototype.createDialog=function(b,c){return a("<div/>").addClass("dialog").append(a("<div/>").addClass("dialog-header").html(b)).append(a("<div/>").addClass("dialog-body").append(c)).on("click",function(){return!1})};b.prototype.createButton=function(b){return a("<button/>").addClass("button").attr("type","button").append(a("<i/>").addClass("icon fa "+b))};b.prototype.createHelpButton=function(b){return $button=a("<a/>").addClass("btn btn-link p-0").attr("data-container","body").attr("data-content","<div><p>"+b+"</p></div>").attr("data-html","true").attr("data-toggle","popover").attr("data-trigger","hover").append(a("<i/>").addClass("icon fa fa-question-circle text-info").attr("title","Help"))};b.prototype.resize=function(){};b.prototype.hasFocus=function(){};b.prototype.destroy=function(){this.sync();this.$checksPanel.remove();this.$checksPanel=null};b.prototype.isResizable=function(){return!1};return{Constructor:b}});
//# sourceMappingURL=ui_checks.min.js.map
