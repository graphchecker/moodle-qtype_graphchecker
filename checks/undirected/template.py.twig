import json
import sys

{% for module in checker_modules %}
import {{ module }}
{% endfor %}

import igraph

def _to_igraph(graph):
    g = igraph.Graph(directed=False)
    if not graph:
        return g
    for vertex in graph['vertices']:
        g.add_vertex(name=vertex['label'])
    for edge in graph['edges']:
        g.add_edge(edge['from'], edge['to'], label=edge['label'])
    return g

student_answer = """{{ STUDENT_ANSWER | e('py') }}"""
student_answer = _to_igraph(json.loads(student_answer))

sample_answer = """{{ QUESTION.answer | e('py') }}"""
if sample_answer == '':
    sample_answer = None
else:
    sample_answer = _to_igraph(json.loads(sample_answer))

preload_answer = """{{ QUESTION.answerpreload | e('py') }}"""
if preload_answer == '':
    preload_answer = None
else:
    preload_answer = _to_igraph(json.loads(preload_answer))

results = []

{% for check in checks %}
result = {{ check.get_check_code() }}
result['module'] = """{{ check.module | e('py') }}"""
result['method'] = """{{ check.method | e('py') }}"""
results.append(result)
{% endfor %}

print(json.dumps(results))

